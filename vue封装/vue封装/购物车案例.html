<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="js/vue.js"></script>
    <style>
        /* *{
            margin: 0px;
            padding: 0px;
        } */
    table{
        border: 1px solid #e9e9e9;
        border-collapse: collapse;
        border-spacing: 0;
    }
    th,td{
        border: 1px solid #e9e9e9;
        padding: 8px 16px;
        text-align:left;
    }
    th{
        background: #f7f7f7;
        color:#5c6b77;
        font-weight: 600;
        text-align:center;
    }
    </style>
</head>
<body>
    <div id="app">
        <div v-if = "book.length > 0">
             <table>
            <thead>
                <tr>
                    <th></th>
                    <th>书籍名称</th>
                    <th>出版日期</th>
                    <th>价格</th>
                    <th>购买数量</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="(item,index) in book">
                    <td>{{item.id}}</td>
                    <td>{{item.name}}</td>
                    <td>{{item.date}}</td>
                    <td>{{item.money | showMoney}}</td>
                    <td>
                        <button @click = "subtractmenth(index)" :disabled = "item.count<=1">-</button>
                        <span>{{item.count}}</span>
                        <button @click = "Addmenth(index)">+</button>
                    </td>
                    <td>
                        <button @click = "removeHandle(index)">删除</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <h3>总价钱：{{moneyS | showMoney}}</h3>
        </div>
       <h2 v-else>购物车没有东西</h2>
    </div>
    <script>
        const app = new Vue({
            el: "#app",
            data: {
                book:[
                    {
                        id: 1,
                        name: "《算法导论》",
                        date: "2016-1",
                        money: 50.00,
                        count: 1
                    },
                    {
                        id: 2,
                        name: "《鬼谷子》",
                        date: "2010-5",
                        money: 85.00,
                        count: 1
                    },
                    {
                        id: 3,
                        name: "《C#知识论》",
                        date: "2008-8-15",
                        money: 100.00,
                        count: 1
                    },
                    {
                        id: 4,
                        name: "《VUE.js详解》",
                        date: "2017-9-30",
                        money: 200.00,
                        count: 1
                    }
                ],
            },
            computed: {
              moneyS(){
                //   let moneyS = 0;
                //   for(let money of this.book){
                //       moneyS += money.money * money.count
                //   }
                  let moneyS = this.book.reduce((pro,n) => pro + n.money * n.count,0);
                  console.log(moneyS)
                  return moneyS;
              }  
            },
            methods: {
                subtractmenth(index){
                    this.book[index].count--;
                },
                Addmenth(index){
                    this.book[index].count++;
                },
                removeHandle(index){
                    this.book.splice(index,1);
                },
                // posta(){
                //     axios.get('/user', {
                //         params: {
                //         ID: 12345
                //         }
                //     })
                //     .then(function (response) {
                //         console.log(response);
                //     })
                //     .catch(function (error) {
                //         console.log(error);
                //     });
                // }
            },
            filters: {
                showMoney(money){
                    return "￥" + money.toFixed(2);
                }
            },
            
        })
        //高阶函数 filter/map/reduce
        const nums = [10,20,30,50,100,150,200,300]
        let total = nums.filter(n => n < 100).map(n => n * 2).reduce( (pro,n) => pro + n,0)
        console.log(total);
    </script>
</body>
</html>